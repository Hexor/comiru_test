(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0c8f69"],{"56b4":function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md full-width absolute-center",staticStyle:{"max-width":"500px"}},[n("q-card",{attrs:{bordered:""}},[n("q-card-section",[n("div",{staticClass:"text-h6"},[e._v("注册 Comiru")])]),n("q-separator",{attrs:{inset:""}}),n("q-card-section",[n("form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[n("q-input",{ref:"username",attrs:{filled:"",label:"用户名","lazy-rules":"",rules:[function(e){return e&&e.length>0||"请输入用户名"}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),n("q-input",{ref:"password",attrs:{"lazy-rules":"",rules:[function(e){return e&&e.length>0||"请输入密码"}],label:"密码",filled:"",type:e.isPwd?"password":"text"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),n("q-input",{ref:"nickname",attrs:{filled:"",label:"昵称","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please type something"}]},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}}),n("q-radio",{attrs:{val:"student",label:"我是学员"},model:{value:e.signType,callback:function(t){e.signType=t},expression:"signType"}}),n("q-radio",{attrs:{val:"teacher",label:"我是教师"},model:{value:e.signType,callback:function(t){e.signType=t},expression:"signType"}}),n("div",{staticClass:"row items-center justify-between"},[n("q-btn",{staticClass:"col",staticStyle:{width:"150px"},attrs:{type:"submit",loading:e.loading,color:"primary"},scopedSlots:e._u([{key:"loading",fn:function(){return[n("q-spinner-hourglass",{staticClass:"on-left"}),e._v("\n              注册中...\n            ")]},proxy:!0}])},[e._v("\n            注册\n            ")])],1),n("div",{staticClass:"row items-center"},[n("q-btn",{staticClass:"col",attrs:{flat:"",color:"primary"},on:{click:function(t){return e.toLoginBtnCallback()}}},[e._v("已有帐号? 前往登录\n          ")])],1)],1)])],1)],1)},i=[],a=n("bc3a"),r=n.n(a),o={data:function(){return{formHasError:!1,signType:"student",loading:!1,nickname:null,username:null,accept:!1,isPwd:!0,password:null,leftDrawerOpen:this.$q.platform.is.desktop}},methods:{toLoginBtnCallback:function(){"/auth/bind_register"===this.$route.path?this.$router.push("/auth/bind_login"):this.$router.push("/auth/login")},onSubmit:function(){var e=this;if(this.$refs.username.validate(),this.$refs.nickname.validate(),this.$refs.password.validate(),this.$refs.username.hasError||this.$refs.nickname.hasError||this.$refs.password.hasError)this.formHasError=!0;else{this.loading=!0;var t=this;if("/auth/bind_register"===this.$route.path){var n="",s={username:this.username,password:this.password,nickname:this.nickname,sign_type:this.signType,is_signup:!0};if(this.isLineTokenInServer())n=this.getLocalTokenType()+"/bind_user";else if(this.isLineTokenInLocal()){n="line/bind_user";var i=this.$q.localStorage.getItem("line_access_token");s["line_token"]=i}r.a.post(n,s).then(function(e){t.$q.notify({color:"info",icon:"thumb_up",message:"注册成功 !",timeout:500}),t.$router.push({path:"/auth/switch"})}).catch(function(t){e.handleErrorResponse(t)}).then(function(){t.loading=!1})}else r.a.post("auth/signup",{username:t.username,password:t.password,nickname:t.nickname,sign_type:t.signType}).then(function(n){var s=new Date;t.updateLocalStorageTokenInfo(n.data.access_token,t.signType,s.getTime()+1e3*n.data.expires_in,n.data.line_exist_in_server),e.$q.notify({color:"info",icon:"thumb_up",message:"注册成功 !",timeout:500}),t.$router.push({path:"/"+t.signType})}).catch(function(t){e.handleErrorResponse(t)}).then(function(){t.loading=!1})}}}},l=o,u=n("2877"),c=Object(u["a"])(l,s,i,!1,null,null,null);t["default"]=c.exports}}]);