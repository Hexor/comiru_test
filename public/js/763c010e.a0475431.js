(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["763c010e"],{"00f0":function(e,n){function t(e){if(Array.isArray(e)){for(var n=0,t=new Array(e.length);n<e.length;n++)t[n]=e[n];return t}}e.exports=t},"097d":function(e,n,t){"use strict";var a=t("5ca1"),r=t("8378"),o=t("7726"),i=t("ebd6"),l=t("bcaa");a(a.P+a.R,"Promise",{finally:function(e){var n=i(this,r.Promise||o.Promise),t="function"==typeof e;return this.then(t?function(t){return l(n,e()).then(function(){return t})}:e,t?function(t){return l(n,e()).then(function(){throw t})}:e)}})},5121:function(e,n){function t(){throw new TypeError("Invalid attempt to spread non-iterable instance")}e.exports=t},"8e72":function(e,n,t){var a=t("00f0"),r=t("b6b4"),o=t("5121");function i(e){return a(e)||r(e)||o()}e.exports=i},b6b4:function(e,n){function t(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}e.exports=t},bf3a:function(e,n,t){"use strict";t.r(n);var a=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"q-pa-md"},[t("q-table",{staticClass:"cn-bold-font",attrs:{title:"教师管理",data:e.data,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.loading,filter:e.filter,"rows-per-page-label":"每页显示数量","no-results-label":"没有任何数据","binary-state-sort":""},on:{"update:pagination":function(n){e.pagination=n},request:e.onRequest},scopedSlots:e._u([{key:"body",fn:function(n){return[t("q-tr",{attrs:{props:n}},[t("q-td",{key:"id",attrs:{props:n}},[e._v("\n            "+e._s(n.row.id)+"\n          ")]),t("q-td",{key:"username",attrs:{props:n}},[e._v("\n            "+e._s(n.row.username)+"\n          ")]),t("q-td",{key:"delete",attrs:{props:n}},[t("q-btn",{attrs:{color:"adminTitle",dense:"",icon:"delete_outline"},on:{click:function(t){return e.deleteUserBtnCallback(n.row)}}})],1)],1)]}},{key:"top-left",fn:function(){return[t("q-btn",{attrs:{dense:"",color:"adminSecondary text-black",disable:e.loading,label:"添加教师"},on:{click:e.addTeacher}})]},proxy:!0},{key:"top-right",fn:function(){return[t("q-input",{attrs:{dense:"",debounce:"300",color:"adminSecondary",placeholder:"搜索用户名, id"},scopedSlots:e._u([{key:"append",fn:function(){return[t("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(n){e.filter=n},expression:"filter"}})]},proxy:!0}])}),t("q-dialog",{model:{value:e.needConfirmDeleteDialog,callback:function(n){e.needConfirmDeleteDialog=n},expression:"needConfirmDeleteDialog"}},[t("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[t("q-card-section",[e._v("\n          确认删除该用户吗? 这同时也将删除该用户的 Line 绑定与教师关注数据.\n        ")]),t("q-card-section",{attrs:{caption:""}},[t("q-item-label",{staticStyle:{"font-size":"14px"},attrs:{caption:""}},[e._v("\n            "+e._s(e.deletingRow)+"\n          ")])],1),t("q-card-actions",{staticClass:"bg-white text-adminPrimary",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-dialog",rawName:"v-close-dialog"}],attrs:{color:"",flat:"",label:"关闭"}}),t("q-btn",{directives:[{name:"close-dialog",rawName:"v-close-dialog"}],staticClass:"text-white bg-adminTitle",attrs:{label:"确认删除"},on:{click:e.sureToDeleteUser}})],1)],1)],1),t("q-dialog",{attrs:{persistent:""},model:{value:e.createTeacherDialog,callback:function(n){e.createTeacherDialog=n},expression:"createTeacherDialog"}},[t("q-card",[t("q-card-section",[t("div",{staticClass:"text-h6"},[e._v("创建新教师帐号")])]),t("q-card-section",[t("q-input",{attrs:{color:"adminSecondary",placeholder:"用户名",rules:[function(e){return e.length<=10||"用户名最长 10 位"}],autofocus:""},model:{value:e.newTeacherModel.username,callback:function(n){e.$set(e.newTeacherModel,"username",n)},expression:"newTeacherModel.username"}}),t("q-input",{attrs:{color:"adminSecondary",rules:[function(e){return e.length>=6&&e.length<20||"密码长度最少6位, 最长20位"}],placeholder:"密码"},model:{value:e.newTeacherModel.password,callback:function(n){e.$set(e.newTeacherModel,"password",n)},expression:"newTeacherModel.password"}}),t("q-input",{attrs:{color:"adminSecondary",placeholder:"昵称"},model:{value:e.newTeacherModel.nickname,callback:function(n){e.$set(e.newTeacherModel,"nickname",n)},expression:"newTeacherModel.nickname"}})],1),t("q-card-actions",{staticClass:"text-adminTitle",attrs:{align:"right"}},[t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"取消"}}),t("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:"创建"},on:{click:e.createTeacher}})],1)],1)],1)],1)},r=[],o=t("8e72"),i=t.n(o),l=(t("097d"),t("bc3a")),s=t.n(l),c=t("b178"),d={data:function(){return{selected:[],newTeacherModel:{username:null,password:null,nickname:null},errorUsername:!1,errorMessageUsername:"",search:"",leaveMessageTextValue:"",needLoginDialog:!1,tgLoginDialogStatus:!1,confirm:!1,contactCard:!1,disableScroll:!1,show:!0,componentKey:0,page:1,items:[],info:"",createTeacherDialog:!1,targetItem:[],messagePlaceHolder:"",requestListPrefix:"",filter:"",deletingRow:null,needConfirmDeleteDialog:!1,loading:!1,pagination:{sortBy:"id",descending:!0,page:1,rowsPerPage:10,rowsNumber:10},columns:[{name:"id",required:!0,label:"ID",align:"left",field:function(e){return e.id},format:function(e){return"".concat(e)},sortable:!0},{name:"username",required:!0,label:"用户名",align:"left",field:function(e){return e.username},format:function(e){return"".concat(e)},sortable:!0},{name:"delete",required:!0,label:"操作",align:"center"}],data:[],editingRow:null}},mounted:function(){var e=window.screen.height;console.log(e),this.pagination.rowsPerPage=Math.round((e-390)/40)-1,this.pagination.rowsPerPage<1&&(this.pagination.rowsPerPage=1),this.onRequest({pagination:this.pagination,filter:""})},methods:{removeUserFromDisplay:function(e){for(var n=0;n<this.data.length;n++)this.data[n]["id"]===e&&this.data.splice(n,1)},deleteUserBtnCallback:function(e){this.deletingRow=e,this.needConfirmDeleteDialog=!0},sureToDeleteUser:function(){var e=this,n=this.deletingRow;this.$q.loading.show({spinner:c["b"],spinnerSize:40,spinnerColor:"adminSecondary",backgroundColor:"white"});var t=this;s.a.delete("admin/teachers/"+n.id).then(function(a){t.removeUserFromDisplay(n.id),e.$q.notify({color:"adminPrimary",icon:"delete_outline",message:"删除成功 !",timeout:500})}).catch(function(n){e.handleErrorResponse(n)}).then(function(){t.$q.loading.hide({delay:500}),t.deletingRow=null})},createTeacher:function(){var e=this;this.$q.loading.show({spinner:c["b"],spinnerSize:40,spinnerColor:"adminSecondary",backgroundColor:"white"});var n=this;s.a.post("admin/teachers",this.newTeacherModel).then(function(t){e.fetchFromServer(1,n.pagination.rowsPerPage,"","id",!0)}).catch(function(n){e.handleErrorResponse(n)}).then(function(){n.$q.loading.hide({delay:500}),e.newTeacherModel={username:null,password:null,nickname:null}})},addTeacher:function(){this.createTeacherDialog=!0},onRequest:function(e){var n=e.pagination,t=n.page,a=n.rowsPerPage,r=n.sortBy,o=n.descending,i=e.filter;this.fetchFromServer(t,a,i,r,o)},fetchFromServer:function(e,n,t,a,r){var o=this;console.log(t),this.loading=!0;var l="asc";r&&(l="desc"),s.a.get("admin/teachers?page_size="+n+"&page="+e+"&keyword="+t+"&sort="+a+"|"+l).then(function(t){var l,s=t["data"]["data"];(l=o.data).splice.apply(l,[0,o.data.length].concat(i()(s))),o.pagination.page=e,o.pagination.rowsPerPage=n,o.pagination.sortBy=a,o.pagination.descending=r,o.pagination.rowsNumber=t["data"]["total"]}).finally(function(){o.loading=!1})}}},u=d,p=t("2877"),f=Object(p["a"])(u,a,r,!1,null,null,null);n["default"]=f.exports}}]);