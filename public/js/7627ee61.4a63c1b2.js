(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["7627ee61"],{"00f0":function(e,t){function n(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}e.exports=n},"097d":function(e,t,n){"use strict";var a=n("5ca1"),i=n("8378"),r=n("7726"),o=n("ebd6"),s=n("bcaa");a(a.P+a.R,"Promise",{finally:function(e){var t=o(this,i.Promise||r.Promise),n="function"==typeof e;return this.then(n?function(n){return s(t,e()).then(function(){return n})}:e,n?function(n){return s(t,e()).then(function(){throw n})}:e)}})},5121:function(e,t){function n(){throw new TypeError("Invalid attempt to spread non-iterable instance")}e.exports=n},"6a82":function(e,t,n){"use strict";n.r(t);var a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"q-pa-md"},[n("q-table",{staticClass:"cn-bold-font",attrs:{title:"关注管理",data:e.data,columns:e.columns,"row-key":"id",pagination:e.pagination,loading:e.loading,filter:e.filter,"rows-per-page-label":"每页显示数量","no-results-label":"没有任何数据","binary-state-sort":""},on:{"update:pagination":function(t){e.pagination=t},request:e.onRequest},scopedSlots:e._u([{key:"body",fn:function(t){return[n("q-tr",{attrs:{props:t}},[n("q-td",{key:"teacher_username",attrs:{props:t}},[e._v("\n          "+e._s(t.row.teacher.username)+"\n        ")]),n("q-td",{key:"student_username",attrs:{props:t}},[e._v("\n          "+e._s(t.row.student.username)+"\n        ")]),n("q-td",{key:"delete",attrs:{props:t}},[n("q-btn",{attrs:{color:"adminTitle",dense:"",icon:"delete_outline"},on:{click:function(n){return e.deleteBtnCallback(t.row)}}})],1)],1)]}},{key:"top-right",fn:function(){return[n("q-input",{attrs:{dense:"",debounce:"300",color:"adminSecondary",placeholder:"搜索用户名"},scopedSlots:e._u([{key:"append",fn:function(){return[n("q-icon",{attrs:{name:"search"}})]},proxy:!0}]),model:{value:e.filter,callback:function(t){e.filter=t},expression:"filter"}})]},proxy:!0}])}),n("q-dialog",{model:{value:e.needConfirmDeleteDialog,callback:function(t){e.needConfirmDeleteDialog=t},expression:"needConfirmDeleteDialog"}},[n("q-card",{staticStyle:{width:"700px","max-width":"80vw"}},[n("q-card-section",[e._v("\n        确认断开该关注关系吗?\n      ")]),n("q-card-section",{attrs:{caption:""}},[n("q-item-label",{staticStyle:{"font-size":"14px"},attrs:{caption:""}},[e._v("\n          "+e._s(e.deletingRow.student.username)+" 于 "+e._s(e.deletingRow.created_at)+" 关注了\n          "+e._s(e.deletingRow.teacher.username)+"\n        ")])],1),n("q-card-actions",{staticClass:"bg-white text-adminPrimary",attrs:{align:"right"}},[n("q-btn",{directives:[{name:"close-dialog",rawName:"v-close-dialog"}],attrs:{color:"",flat:"",label:"关闭"}}),n("q-btn",{directives:[{name:"close-dialog",rawName:"v-close-dialog"}],staticClass:"text-white bg-adminTitle",attrs:{label:"确认删除"},on:{click:e.sureToDelete}})],1)],1)],1)],1)},i=[],r=(n("7f7f"),n("6762"),n("2fdb"),n("ac6a"),n("8e72")),o=n.n(r),s=(n("097d"),n("bc3a")),l=n.n(s),c=n("b178"),d={data:function(){return{deletingRow:{student:"",teacher:""},search:"",leaveMessageTextValue:"",needConfirmDeleteDialog:!1,tgLoginDialogStatus:!1,confirm:!1,contactCard:!1,disableScroll:!1,show:!0,componentKey:0,page:1,items:[],info:"",targetItem:[],messagePlaceHolder:"",requestListPrefix:"",filter:"",loading:!1,pagination:{sortBy:"updated_at",descending:!0,page:1,rowsPerPage:10,rowsNumber:10},columns:[{name:"teacher_username",required:!0,label:"教师用户名",align:"left",sortable:!0},{name:"student_username",required:!0,label:"学员用户名",align:"left",sortable:!0},{name:"delete",required:!0,label:"操作",align:"center"}],data:[],editingRow:null}},mounted:function(){var e=window.screen.height;console.log(e),this.pagination.rowsPerPage=Math.round((e-390)/40)-1,this.pagination.rowsPerPage<1&&(this.pagination.rowsPerPage=1),this.onRequest({pagination:this.pagination,filter:""})},methods:{removeFromDisplay:function(e){for(var t=0;t<this.data.length;t++)this.data[t]["id"]===e&&this.data.splice(t,1)},deleteBtnCallback:function(e){this.deletingRow=e,this.needConfirmDeleteDialog=!0},sureToDelete:function(){var e=this,t=this.deletingRow;this.$q.loading.show({spinner:c["b"],spinnerSize:40,spinnerColor:"adminSecondary",backgroundColor:"white"});var n=this;l.a.delete("admin/teacher_students/"+t.id).then(function(a){n.removeFromDisplay(t.id),e.$q.notify({color:"adminPrimary",icon:"delete_outline",message:"删除成功 !",timeout:500})}).catch(function(t){e.handleErrorResponse(t)}).then(function(){n.$q.loading.hide({delay:500}),n.deletingRow={student:"",teacher:""}})},onRequest:function(e){console.log("onrequest");var t=e.pagination,n=t.page,a=t.rowsPerPage,i=t.sortBy,r=t.descending,o=e.filter;this.fetchFromServer(n,a,o,i,r)},fetchFromServer:function(e,t,n,a,i){var r=this;this.loading=!0;var s="asc",c="";i&&(s="desc"),"teacher_username"===a&&(c="teacher_id"),"student_username"===a&&(c="student_id"),l.a.get("admin/teacher_students?page_size="+t+"&page="+e+"&keyword="+n+"&sort="+c+"|"+s).then(function(n){var s,l=n["data"]["data"];(s=r.data).splice.apply(s,[0,r.data.length].concat(o()(l))),r.pagination.page=e,r.pagination.rowsPerPage=t,r.pagination.sortBy=a,r.pagination.descending=i,r.pagination.rowsNumber=n["data"]["total"]}).finally(function(){r.loading=!1})},getRowsNumberCount:function(e){if(!e)return this.original.length;var t=0;return this.original.forEach(function(n){n["name"].includes(e)&&++t}),t}}},u=d,g=n("2877"),f=Object(g["a"])(u,a,i,!1,null,null,null);t["default"]=f.exports},"8e72":function(e,t,n){var a=n("00f0"),i=n("b6b4"),r=n("5121");function o(e){return a(e)||i(e)||r()}e.exports=o},b6b4:function(e,t){function n(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}e.exports=n}}]);