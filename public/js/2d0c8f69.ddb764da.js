(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["2d0c8f69"],{"56b4":function(e,t,s){"use strict";s.r(t);var n=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"q-pa-md",staticStyle:{"max-width":"500px"}},[s("q-card",{attrs:{bordered:""}},[s("q-card-section",[s("div",{staticClass:"text-h6"},[e._v("注册 Comiru")])]),s("q-separator",{attrs:{inset:""}}),s("q-card-section",[s("form",{staticClass:"q-gutter-md",on:{submit:function(t){return t.preventDefault(),t.stopPropagation(),e.onSubmit(t)}}},[s("q-input",{ref:"username",attrs:{filled:"",label:"用户名","lazy-rules":"",rules:[function(e){return e&&e.length>0||"请输入用户名"}]},model:{value:e.username,callback:function(t){e.username=t},expression:"username"}}),s("q-input",{ref:"password",attrs:{"lazy-rules":"",rules:[function(e){return e&&e.length>0||"请输入密码"}],label:"密码",filled:"",type:e.isPwd?"password":"text"},scopedSlots:e._u([{key:"append",fn:function(){return[s("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.isPwd?"visibility_off":"visibility"},on:{click:function(t){e.isPwd=!e.isPwd}}})]},proxy:!0}]),model:{value:e.password,callback:function(t){e.password=t},expression:"password"}}),s("q-input",{ref:"nickname",attrs:{filled:"",label:"昵称","lazy-rules":"",rules:[function(e){return e&&e.length>0||"Please type something"}]},model:{value:e.nickname,callback:function(t){e.nickname=t},expression:"nickname"}}),s("q-radio",{attrs:{val:"student",label:"我是学员"},model:{value:e.signType,callback:function(t){e.signType=t},expression:"signType"}}),s("q-radio",{attrs:{val:"teacher",label:"我是教师"},model:{value:e.signType,callback:function(t){e.signType=t},expression:"signType"}}),s("div",{staticClass:"row items-center justify-between"},[s("q-btn",{staticClass:"col",staticStyle:{width:"150px"},attrs:{type:"submit",loading:e.loading,color:"primary"},scopedSlots:e._u([{key:"loading",fn:function(){return[s("q-spinner-hourglass",{staticClass:"on-left"}),e._v("\n              注册中...\n            ")]},proxy:!0}])},[e._v("\n            注册\n            ")])],1),s("div",{staticClass:"row items-center"},[s("q-btn",{staticClass:"col",attrs:{flat:"",color:"primary"},on:{click:function(t){return e.toLoginBtnCallback()}}},[e._v("已有帐号? 前往登录\n          ")])],1)],1)])],1)],1)},i=[],a=s("bc3a"),r=s.n(a),o={data:function(){return{formHasError:!1,signType:"student",loading:!1,nickname:null,username:null,accept:!1,isPwd:!0,password:null,leftDrawerOpen:this.$q.platform.is.desktop}},methods:{toLoginBtnCallback:function(){"/auth/bind_register"===this.$route.path?this.$router.push("/auth/bind_login"):this.$router.push("/auth/login")},onSubmit:function(){var e=this;if(this.$refs.username.validate(),this.$refs.nickname.validate(),this.$refs.password.validate(),this.$refs.username.hasError||this.$refs.nickname.hasError||this.$refs.password.hasError)this.formHasError=!0;else{this.loading=!0;var t=this;if("/auth/bind_register"===this.$route.path){var s="",n={username:this.username,password:this.password,nickname:this.nickname,sign_type:this.signType,is_signup:!0};if(this.isLineTokenInServer())s=this.getLocalTokenType()+"/bind_user";else if(this.isLineTokenInLocal()){s="line/bind_user";var i=this.$q.localStorage.getItem("line_access_token");n["line_token"]=i}r.a.post(s,n).then(function(e){t.$q.notify({color:"info",icon:"thumb_up",message:"注册成功 !",timeout:500}),t.$router.push({path:"/auth/switch"})}).catch(function(e){var s=e.response.data.message;t.$q.notify({multiLine:!0,color:"negative",message:s})}).then(function(){t.loading=!1})}else r.a.post("auth/signup",{username:t.username,password:t.password,nickname:t.nickname,sign_type:t.signType}).then(function(s){var n=new Date;t.updateLocalStorageTokenInfo(s.data.access_token,t.signType,n.getTime()+1e3*s.data.expires_in,s.data.line_exist_in_server),e.$q.notify({color:"info",icon:"thumb_up",message:"注册成功 !",timeout:500}),t.$router.push({path:"/"+t.signType})}).catch(function(e){var s=e.response.data.message;t.$q.notify({multiLine:!0,color:"negative",message:s})}).then(function(){t.loading=!1})}}}},l=o,u=s("2877"),c=Object(u["a"])(l,n,i,!1,null,null,null);t["default"]=c.exports}}]);